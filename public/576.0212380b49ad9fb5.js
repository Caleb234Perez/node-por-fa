"use strict";(self.webpackChunkminiProyecto2=self.webpackChunkminiProyecto2||[]).push([[576],{201:(Y,h,o)=>{o.r(h),o.d(h,{MovieDetailsModule:()=>P});var l=o(6895),c=o(433),r=o(4331),m=o(5861),p=o(4004),e=o(4650),v=o(2576),f=o(7951),g=o(1179),M=o(1205),u=o(9871);function _(t,n){if(1&t&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&t){const i=n.$implicit;e.xp6(1),e.Oqu(i.name)}}function b(t,n){if(1&t){const i=e.EpF();e.TgZ(0,"div",14),e._UZ(1,"br"),e._uU(2," Esta disponible "),e._UZ(3,"br"),e.TgZ(4,"input",15),e.NdJ("ngModelChange",function(a){e.CHM(i);const d=e.oxw(2);return e.KtG(d.rsr=a)})("change",function(){e.CHM(i);const a=e.oxw(2);return e.KtG(a.verFecha())}),e.qZA(),e._UZ(5,"br"),e.TgZ(6,"button",16),e.NdJ("click",function(){e.CHM(i);const a=e.oxw(2);return e.KtG(a.agregar())}),e._uU(7," Agregar "),e.qZA(),e.TgZ(8,"div",17),e._uU(9," Precio: $14/dia "),e.qZA()()}if(2&t){const i=e.oxw(2);e.xp6(4),e.Q6J("ngModel",i.rsr),e.xp6(2),e.Q6J("disabled",i.habilitar)}}function C(t,n){if(1&t&&(e._uU(0,"No disponible "),e._UZ(1,"br"),e.TgZ(2,"p"),e._uU(3),e.qZA()),2&t){const i=e.oxw(2);e.xp6(3),e.lnq("La pelicula estar disponible el ",i.devD,"-",i.devM,"-",i.devA,"")}}function D(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,b,10,2,"div",11),e.YNc(2,C,4,3,"ng-template",12,13,e.W1O),e.qZA()),2&t){const i=e.MAs(3),s=e.oxw();e.xp6(1),e.Q6J("ngIf",s.disponible)("ngIfElse",i)}}function y(t,n){1&t&&e._uU(0," debes tener una sesion iniciada para poder tener una reservacion ")}const Z=[{path:"",component:(()=>{class t{constructor(i,s,a,d,T,F,U){this.movies=i,this.getmovie=s,this.route=a,this.dbPel=d,this.router=T,this.auth=F,this.mail=U,this.disponible=!1,this.id=0,this.habilitar=!0}ngOnInit(){var i=this;return(0,m.Z)(function*(){i.idMov=i.route.snapshot.paramMap.get("id"),i.movie=yield i.movies.getMovie(i.idMov),i.obtener(),i.auth.authState.subscribe(s=>{console.log(s),i.user=s})})()}obtener(){this.dbPel.getall().snapshotChanges().pipe((0,p.U)(i=>i.map(s=>({id:s.payload.key,...s.payload.val()})))).subscribe(i=>{this.Pelis=i,this.disponible=this.verificar(),console.log(this.Pelis)})}verificar(){if(console.log(this.Pelis),null==this.Pelis)return console.log("ok"),!0;for(const i of this.Pelis)if(i.peli==this.movie.original_title)return this.devD=i.diaD,this.devM=i.mesD,this.devA=i.anioD,!1;return!0}verFecha(){this.anio=Number.parseFloat(this.rsr.slice(0,4)),this.mes=Number.parseFloat(this.rsr.slice(5,7)),this.dia=Number.parseFloat(this.rsr.slice(8,10)),this.actual=new Date,this.habilitar=!0,(this.anio>this.actual.getFullYear()||this.anio==this.actual.getFullYear()&&this.mes>this.actual.getMonth()+1||this.anio==this.actual.getFullYear()&&this.mes==this.actual.getMonth()+1&&this.dia>=this.actual.getDate())&&(this.habilitar=!1,this.runDate()),this.habilitar&&this.runError()}agregar(){console.log(this.dbPel.getall()),this.lista=JSON.parse(localStorage.getItem("reservas")||"[]"),this.runSucces(),2===this.mes&&29===this.dia||28===this.dia?(this.dia=1,this.mes=this.mes+1):this.dia+1>30&&this.mes+1>12?(this.dia=1,this.mes=1,this.anio=this.anio+1):this.dia+1>30&&(this.dia=1,this.mes=this.mes+1),this.res={peli:this.movie.original_title,diaD:this.dia,mesD:this.mes,anioD:this.anio,diaR:this.actual.getDate(),mesR:this.actual.getMonth(),anioR:this.actual.getFullYear(),poster:this.movie.poster_path,pop:this.movie.vote_average,user:this.user.email},this.dbPel.create(this.res);let s={email:this.user.email};console.log(this.user.email),this.mail.SendMail("https://proyecto-f.onrender.com/send-email",s).then().catch(a=>{console.log(a)}),this.router.navigate(["/home"])}runSucces(){alertify.success("La pelicula se reservo con exito")}runError(){alertify.error("Seleccione una fecha no pasada")}runDate(){alertify.success("Fecha valida")}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(v.S),e.Y36(f.c),e.Y36(r.gz),e.Y36(g.O),e.Y36(r.F0),e.Y36(M.zQ),e.Y36(u.b))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-movie-details"]],decls:21,vars:9,consts:[["href","https://fonts.googleapis.com/css2?family=Bruno+Ace+SC&display=swap","rel","stylesheet"],[1,"col-12"],[1,"felipe"],[1,"alexander"],["alt","",3,"src"],[1,"resumen"],[1,"title"],[1,"generos"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["elseBlock",""],["class","dispo",4,"ngIf","ngIfElse"],["class","dispo"],["noDisponible",""],[1,"dispo"],["type","date",1,"btn-dark","cal",3,"ngModel","ngModelChange","change"],[1,"btn","btn-info","bot",3,"disabled","click"],[1,"bot"]],template:function(i,s){if(1&i&&(e.TgZ(0,"head"),e._UZ(1,"link",0),e.TgZ(2,"title"),e._uU(3),e.qZA()(),e.TgZ(4,"div",1)(5,"div",2)(6,"div",3),e._UZ(7,"img",4),e.qZA(),e.TgZ(8,"div",5)(9,"p"),e._uU(10),e.qZA()(),e.TgZ(11,"div",6)(12,"h1"),e._uU(13),e.ALo(14,"uppercase"),e.qZA()(),e.TgZ(15,"div",7),e.YNc(16,_,2,1,"h5",8),e.qZA(),e.YNc(17,D,4,2,"div",9),e.YNc(18,y,1,0,"ng-template",null,10,e.W1O),e._UZ(20,"router-outlet"),e.qZA()()),2&i){const a=e.MAs(19);e.xp6(3),e.Oqu(s.movie.original_title),e.xp6(4),e.MGl("src","https://www.themoviedb.org/t/p/w300_and_h450_bestv2",s.movie.poster_path,"",e.LSH),e.xp6(3),e.Oqu(s.movie.overview),e.xp6(3),e.Oqu(e.lcZ(14,7,s.movie.original_title)),e.xp6(3),e.Q6J("ngForOf",s.movie.genres),e.xp6(1),e.Q6J("ngIf",s.user)("ngIfElse",a)}},dependencies:[l.sg,l.O5,r.lC,c.Fj,c.JJ,c.On,l.gd],styles:['*[_ngcontent-%COMP%]{font-family:Bruno Ace SC,cursive}.felipe[_ngcontent-%COMP%]{height:100%;width:100%;margin:10% 0% 0%;padding:0;display:grid;font-family:Bruno Ace SC,cursive;row-gap:5%;column-gap:5%;background-color:#000;color:#fff;grid-template-areas:"title title img" "generos generos img" "resumen resumen img" "directores directores img" "dispo dispo img" "cal bot img ";border-radius:10px}.precio[_ngcontent-%COMP%]{grid-area:precio}.dispo[_ngcontent-%COMP%]{grid-area:dispo;display:flex;justify-content:center;flex-direction:column;align-items:center}.cal[_ngcontent-%COMP%]{grid-area:cal;margin-right:35%;margin-left:35%}.bot[_ngcontent-%COMP%]{grid-area:bot}.alexander[_ngcontent-%COMP%]{grid-area:img}.resumen[_ngcontent-%COMP%]{grid-area:resumen;margin-right:5%;margin-left:5%}.title[_ngcontent-%COMP%]{grid-area:title;display:flex;align-items:center;justify-content:center}.generos[_ngcontent-%COMP%]{grid-area:generos;display:flex;align-items:center;justify-content:space-around}.directores[_ngcontent-%COMP%]{grid-area:directores;background-color:#fff;color:#000;display:flex;align-items:center;justify-content:space-around}img[_ngcontent-%COMP%]{border-radius:10px}']}),t})()}];let x=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[r.Bz.forChild(Z),r.Bz]}),t})();var O=o(2011),A=o(2340);let P=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[g.O,u.b],imports:[l.ez,x,c.u5,O.hO.initializeApp(A.N.firebaseConfig)]}),t})()}}]);